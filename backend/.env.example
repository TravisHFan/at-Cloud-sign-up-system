# Environment Configuration for @Cloud Sign-up System Backend

# =============================================================================
# CORE SERVER CONFIGURATION
# =============================================================================
# CRITICAL: Set to 'production' in production environment for security & performance
NODE_ENV=development
PORT=5001  #If using Render: You're already set with PORT=10000 in render.yaml
FRONTEND_URL=http://localhost:5173
BACKEND_URL=https://at-cloud-sign-up-system-backend.onrender.com. 
#You only need BACKEND_URL in production when: 
#üìß Sending emails with embedded file/avatar links
#üîó External systems need to access your uploaded files
#üåê Cross-domain file sharing requirements


# Deployment & Clustering
WEB_CONCURRENCY=1
PM2_CLUSTER_MODE=false
NODE_APP_INSTANCE=
SINGLE_INSTANCE_ENFORCE=false
#it's completely OK to not set these variables in both development and production (Render)


# =============================================================================
# DATABASE CONFIGURATION
# =============================================================================
MONGODB_URI=mongodb://localhost:27017/atcloud-signup
MONGODB_TEST_URI=mongodb://localhost:27017/atcloud-signup-test


# =============================================================================
# JWT & AUTHENTICATION CONFIGURATION
# =============================================================================
# Primary JWT Configuration (Active System)
JWT_ACCESS_SECRET=your-super-secret-access-token-key-change-this-in-production
JWT_REFRESH_SECRET=your-super-secret-refresh-token-key-change-this-in-production
JWT_ACCESS_EXPIRE=3h
JWT_REFRESH_EXPIRE=7d

# Fallback JWT Secret (used by role rejection & guest decline tokens when specific secrets not set)
JWT_SECRET=your-super-secret-jwt-key-change-in-production

# Token Secrets
ROLE_ASSIGNMENT_REJECTION_SECRET=your-role-rejection-secret-key
GUEST_INVITATION_DECLINE_SECRET=your-guest-decline-secret-key

# Security
BCRYPT_ROUNDS=12

# =============================================================================
# EMAIL CONFIGURATION
# =============================================================================
# SMTP Settings
SMTP_HOST=smtp.gmail.com
SMTP_PORT=587
SMTP_USER=your-email@gmail.com
SMTP_PASS=your-app-password
SMTP_SECURE=false  # false = STARTTLS (recommended for port 587)
EMAIL_FROM=noreply@atcloud.org

# System Email Recipients
SYSTEM_EMAIL=ops@yourdomain.org #When users submit feedback through your app, the system tries to email administrators using this fallback chain:
#const systemEmail = process.env.SYSTEM_EMAIL || process.env.SMTP_USER || "";
FALLBACK_ADMIN_EMAIL=noreply@atcloud.org

# Email Deduplication
EMAIL_DEDUP_ENABLE=false
EMAIL_DEDUP_TTL_MS=120000
#This is completely OK to leave unset in both development and production.
#When Would You Enable Deduplication?
    #High-volume systems with potential for accidental duplicate triggers
    #Bulk notification scenarios where users might receive duplicates
    #Race conditions causing multiple identical notifications
    #User complaints about receiving duplicate emails


# =============================================================================
# FILE UPLOAD CONFIGURATION
# =============================================================================
# Upload directory path (actively used)
UPLOAD_DESTINATION=/uploads/
# Note: File size limits (10MB) and allowed types (image/*) are hardcoded in upload.ts

# =============================================================================
# RATE LIMITING CONFIGURATION
# =============================================================================
RATE_LIMIT_WINDOW_MS=900000
RATE_LIMIT_MAX_REQUESTS=100

# =============================================================================
# CACHING CONFIGURATION
# =============================================================================
# Public Events List Cache
PUBLIC_EVENTS_LIST_CACHE_MAX=300
PUBLIC_EVENTS_LIST_CACHE_TTL_MS=60000
#OK to leave unset in both development and production.
#Development:
#Small traffic, 300 entries and 60s TTL are perfect
#No need to configure - focus on development
#‚úÖ Production:
#Unless you have very high traffic, defaults are excellent
#300 entries √ó 60s TTL handles most production loads well



# Short Link Cache
SHORTLINK_CACHE_MAX=3000
SHORTLINK_CACHE_TTL_MS=300000
SHORTLINK_CACHE_NEGATIVE_TTL_MS=30000
SLC_RESERVED_KEYS=
#OK to leave unset in both development and production


# =============================================================================
# SHORT LINKS CONFIGURATION
# =============================================================================
PUBLIC_SHORT_BASE_URL=

# =============================================================================
# SCHEDULER CONFIGURATION
# =============================================================================
SCHEDULER_ENABLED=true
API_BASE_URL=
# OK to leave both unset in development and production. The system has excellent intelligent defaults!

# =============================================================================
# AUDIT LOG CONFIGURATION
# =============================================================================
AUDIT_LOG_RETENTION_MONTHS=12
AUDIT_LOG_TTL_FALLBACK_DAYS=730

# =============================================================================
# LOGGING CONFIGURATION
# =============================================================================
LOG_LEVEL=info
LOG_FORMAT=
#OK to leave both unset in development and production. The defaults are perfectly chosen for your system


# =============================================================================
# FEATURE FLAGS
# =============================================================================
# These feature flags are actually used in the codebase and have intelligent defaults

# Prometheus metrics collection (default: enabled when not set)
ENABLE_PROMETHEUS=true #if don't set, it defaults to true, means Prometheus metrics are enabled
# Rate limiting protection (default: enabled when not set) 
ENABLE_RATE_LIMITING=true #if don't set, it defaults to true, means rate limiting is enabled
# Guest-to-user auto-migration on signup (default: enabled when not set)
ENABLE_GUEST_AUTO_MIGRATION=true #if don't set, it defaults to true, means guest auto-migration is enabled


# =============================================================================
# NOTIFICATION SYSTEM CONFIGURATION
# =============================================================================
# Timeouts (milliseconds)
EMAIL_TIMEOUT=15000
DB_TIMEOUT=5000
WS_TIMEOUT=3000
#OK to leave unset in both development and production. The defaults are well-chosen for your notification system


# Retry Configuration
EMAIL_RETRIES=3
DB_RETRIES=2
WS_RETRIES=3

# System Behavior
ENABLE_ROLLBACK=true
ENABLE_METRICS=true
STRICT_MODE=false
ENABLE_QUEUING=false

# Performance & Monitoring
METRICS_INTERVAL=60000
ALERT_THRESHOLD=0.95
MAX_METRICS_HISTORY=1000
MAX_CONCURRENT_TRIOS=50
BATCH_SIZE=10
COOLDOWN_PERIOD=1000

# Rate Limiting for Notifications
MAX_RETRIES_PER_USER=5
RATE_LIMIT_WINDOW=300000
MAX_TRIOS_PER_WINDOW=20
PUBLIC_REG_LIMIT_PER_EMAIL=8

# =============================================================================
# DEVELOPMENT & TESTING
# =============================================================================
VITE_DEV_FRONTEND=http://localhost:5176

